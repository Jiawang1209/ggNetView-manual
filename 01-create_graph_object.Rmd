# Build graph object

----

Basic workflow of **ggNetView**ï¼š

1. Build a **graph object**
2. Understand and manipulate the **graph object**
3. Visualize the network using **layout algorithms**
4. Retrieve **topology** of network

----


> Load R Package


```{r warning=F, message=F}
library(tidyverse)
library(ggNetView)
```

----

## Build graph from matrix

>  Example data

```{r}
# Access built-in example datasets in ggNetView

# Raw ASV or OTU table
data("otu_tab")
dim(otu_tab)
otu_tab[1:5, 1:5]


# Rarefied ASV or OTU table
data("otu_rare")
dim(otu_rare)
otu_rare[1:5, 1:5]

# Relative abundance table of rarefied ASVs or OTUs
data("otu_rare_relative")
dim(otu_rare_relative)
otu_rare_relative[1:5, 1:5]

# Taxonomic annotation table of ASVs or OTUs
data("tax_tab")
tax_tab[1:5, 1:5]
```

> Build graph object

```{r message=F}
graph_obj <- build_graph_from_mat(
  mat = otu_rare_relative,
  transfrom.method = "none", #  based your input data
  r.threshold = 0.7,
  p.threshold = 0.05,
  method = "WGCNA",
  cor.method = "pearson",
  proc = "Bonferroni",
  module.method = "Fast_greedy",
  node_annotation = tax_tab,
  top_modules = 15,
  seed = 1115
)

graph_obj
```


----

## Build graph from data frame

>  Example data

```{r}
# Access built-in example datasets in ggNetView
data("ppi_example")
df = ppi_example$ppi
head(df)

node_annotation = ppi_example$annotation
head(node_annotation)
```

> Build graph object

```{r message=F}
graph_obj_from_df <- build_graph_from_df(
  df = df,
  node_annotation = node_annotation,
  directed = F,
  module.method = "Fast_greedy",
  top_modules = 15,
  seed = 1115
)

graph_obj_from_df
```


```{r message=F}
graph_obj_from_df2 <- build_graph_from_df(
  df = df,
  node_annotation = NULL,
  directed = F,
  module.method = "Fast_greedy",
  top_modules = 15,
  seed = 1115
)

graph_obj_from_df2
```



----

## Build graph from data frame with module

>  Example data

```{r}
# Access built-in example datasets in ggNetView
data("ppi_module")
df = ppi_module$ppi
head(df)

node_annotation = ppi_module$annotation
head(node_annotation)
```

> Build graph object

```{r message=F}
graph_obj_from_module <- build_graph_from_module(
  df = df,
  node_annotation = node_annotation,
  directed = F,
  top_modules = 15,
  seed = 1115
)

graph_obj_from_module
```


----

## Build graph from adjacency matrix

>  Example data

```{r}
data("adjacency_matrix_example")
dim(adjacency_matrix_example)
adjacency_matrix_example[1:5, 1:5]

data("tax_tab")
dim(tax_tab)
tax_tab[1:5, 1:5]

```


> Build graph object

```{r message=F}
graph_obj_adj <- build_graph_from_adj_mat(
  adjacency_matrix = adjacency_matrix_example,
  module.method = "Fast_greedy",
  node_annotation = tax_tab,
  top_modules = 15,
  seed = 1115
)

graph_obj_adj

```

----

## Build graph from double matrix

>  Example data

```{r}
data("BASV_tab")
dim(BASV_tab)
BASV_tab[1:5, 1:5]

data("FASV_tab")
dim(FASV_tab)
FASV_tab[1:5, 1:5]


data("double_mat_node_df")
dim(double_mat_node_df)
head(double_mat_node_df)
```


> Build graph object

```{r}
graph_obj_double_mat <- build_graph_from_double_mat(
  mat1 = BASV_tab,
  mat2 = FASV_tab,
   module.method = "Fast_greedy",
  node_annotation = double_mat_node_df,
  top_modules = 15,
  seed = 1115
)

graph_obj_double_mat

```



----





