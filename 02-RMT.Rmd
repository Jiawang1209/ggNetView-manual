# Random Matrix Theory (RMT)â€“based random network


> When a numerical matrix is used as input, it is necessary to filter and screen the resulting correlation matrix. Empirical thresholds are commonly adopted, usually between 0.6 to 0.85; however, these thresholds are largely subjective.

> Compared with empirical thresholding, random matrix theory (RMT) provides a data-driven and objective approach for determining correlation thresholds, effectively separating true biological signals from random noise and improving the robustness and comparability of ecological networks.


## Random Matrix Theory (RMT) 



> Load R Package


```{r warning=F, message=F}
library(tidyverse)
library(ggNetView)
```

----

## Example data

> Example data

```{r}
# Access built-in example datasets in ggNetView

# Relative abundance table of rarefied ASVs or OTUs
data("otu_rare_relative")
dim(otu_rare_relative)
otu_rare_relative[1:5, 1:5]

# Taxonomic annotation table of ASVs or OTUs
data("tax_tab")
dim(tax_tab)
tax_tab[1:5, 1:5]
```


## Compute RMT threshold 


```{r}
out <- ggNetView_RMT(mat = otu_rare_relative, 
                     transfrom.method = "none", 
                     method = "WGCNA", 
                     cor.method = "pearson",
                     unfold.method = "gaussian",
                     bandwidth = "nrd0",
                     nr.fit.points = 20,
                     discard.outliers = TRUE,
                     discard.zeros = TRUE,
                     min.mat.dim = 40,
                     max.ev.spacing = 3,
                     save_plots = FALSE,
                     out_dir = "RMT_plots",
                     verbose = TRUE,
                     seed = 1115
                     )

out$chosen_threshold
```



```{r}
out2 <- ggNetView_RMT(mat = otu_rare_relative, 
                     transfrom.method = "none", 
                     method = "cor", 
                     cor.method = "pearson",
                     unfold.method = "gaussian",
                     bandwidth = "nrd0",
                     nr.fit.points = 20,
                     discard.outliers = TRUE,
                     discard.zeros = TRUE,
                     min.mat.dim = 40,
                     max.ev.spacing = 3,
                     save_plots = FALSE,
                     out_dir = "RMT_plots",
                     verbose = TRUE,
                     seed = 1115
                     )


out2$chosen_threshold
```



## Build graph from matrix based on RMT-threshold

> Build graph object

```{r message=F}
graph_obj <- build_graph_from_mat(
  mat = otu_rare_relative,
  transfrom.method = "none", #  based your input data
  r.threshold = out$chosen_threshold,
  p.threshold = 0.05,
  method = "WGCNA",
  cor.method = "pearson",
  proc = "Bonferroni",
  module.method = "Fast_greedy",
  node_annotation = tax_tab,
  top_modules = 15,
  seed = 1115
)

graph_obj
```






